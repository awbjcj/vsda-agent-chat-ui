(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{53718:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tH});var a=r(515),s=r(29614),l=r(35683),n=r(51937),i=r(52994),o=r(51771);function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,i.$)(t))}var c=r(87992),u=r(69722),m=r(29994);function p(e){let{className:t,type:r,...s}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:d("border-input file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}var x=r(48267);let h=(0,r(73268).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",brand:"bg-[#2F6868] hover:bg-[#2F6868]/90 border-[#2F6868] text-white"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function f(e){let{className:t,variant:r,size:s,asChild:l=!1,...n}=e,i=l?x.DX:"button";return(0,a.jsx)(i,{"data-slot":"button",className:d(h({variant:r,size:s,className:t})),...n})}function g(e){let{className:t,width:r,height:s}=e;return(0,a.jsx)("svg",{width:r,height:s,viewBox:"0 0 98 51",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.5144 0.394531H73.3011C86.9178 0.394531 97.9949 11.5154 97.9949 25.1847C97.9949 38.8539 86.9178 49.9748 73.3011 49.9748H25.5144C11.8977 49.9748 0.820557 38.8539 0.820557 25.1847C0.820557 11.5154 11.8977 0.394531 25.5144 0.394531ZM47.4544 38.8228C48.0543 39.454 48.9423 39.4228 49.7291 39.2592L49.7369 39.2631C50.1021 38.9659 49.583 38.5896 49.0873 38.2302C48.79 38.0146 48.5012 37.8052 48.4165 37.6226C48.6908 37.2878 47.8793 36.5277 47.2475 35.936C46.9822 35.6875 46.7487 35.4688 46.6404 35.3236C46.1908 34.8341 46.0101 34.2163 45.8283 33.5949C45.7077 33.1826 45.5866 32.7687 45.3862 32.3895C44.1516 29.5216 42.7377 26.6771 40.7552 24.2495C39.4811 22.636 38.027 21.1911 36.5723 19.7457C35.6346 18.8139 34.6967 17.8819 33.8066 16.9044C32.8908 15.9585 32.3396 14.7932 31.7874 13.6259C31.3252 12.6488 30.8624 11.6702 30.1844 10.8179C28.1317 7.77859 21.6506 6.94861 20.7002 11.2427C20.7041 11.3751 20.6613 11.4609 20.5444 11.5466C20.0186 11.9324 19.5512 12.3688 19.1578 12.8987C18.1958 14.243 18.0478 16.5225 19.2474 17.7305C19.2492 17.7046 19.2508 17.6787 19.2525 17.653C19.2926 17.043 19.3301 16.4729 19.8122 16.0355C20.7392 16.8343 22.1452 17.1187 23.2202 16.5225C24.5164 18.3826 24.9292 20.6311 25.3435 22.8873C25.6886 24.7667 26.0347 26.6515 26.8931 28.3214C26.9109 28.351 26.9286 28.3805 26.9464 28.4101C27.451 29.2506 27.9637 30.1046 28.6108 30.8386C28.8459 31.2032 29.3286 31.5967 29.8104 31.9895C30.4462 32.5079 31.0805 33.025 31.1425 33.4727C31.1453 33.6676 31.1445 33.865 31.1436 34.0636C31.1386 35.2395 31.1334 36.4572 31.8864 37.4239C32.3032 38.2695 31.2827 39.1189 30.4609 39.0137C30.0103 39.0762 29.518 38.9574 29.0292 38.8395C28.3604 38.6781 27.6981 38.5182 27.158 38.8267C27.0065 38.9907 26.7889 38.9965 26.5702 39.0022C26.311 39.0091 26.0503 39.016 25.896 39.2865C25.8644 39.3669 25.7903 39.4577 25.7133 39.5521C25.5443 39.7594 25.3611 39.9841 25.5806 40.1554C25.6002 40.1405 25.6198 40.1255 25.6393 40.1106C25.9718 39.8568 26.2885 39.6149 26.7374 39.7658C26.6777 40.0975 26.8918 40.1863 27.1058 40.2751C27.1432 40.2906 27.1805 40.3062 27.2164 40.323C27.2141 40.4 27.199 40.4777 27.1839 40.5548C27.1479 40.739 27.1126 40.9196 27.2554 41.0789C27.3232 41.0099 27.3831 40.9325 27.4431 40.8548C27.5901 40.6649 27.7378 40.4739 28.0032 40.4048C28.5871 41.1849 29.1753 40.8609 29.9134 40.4543C30.7458 39.9958 31.7688 39.4322 33.1912 40.2294C32.646 40.2022 32.1591 40.2684 31.793 40.7204C31.7034 40.8217 31.6255 40.9386 31.7852 41.0711C32.6268 40.5256 32.9769 40.7217 33.3065 40.9062C33.5444 41.0394 33.7715 41.1666 34.165 41.0049C34.258 40.9563 34.351 40.9062 34.4441 40.8559C35.0759 40.5149 35.7167 40.169 36.4669 40.2879C35.9065 40.4496 35.7072 40.8049 35.4896 41.1928C35.382 41.3845 35.2699 41.5843 35.1075 41.7725C35.0219 41.8582 34.9829 41.9595 35.0803 42.1037C36.2536 42.0061 36.6969 41.7085 37.2959 41.3064C37.5817 41.1145 37.903 40.8989 38.3559 40.6698C38.8566 40.3614 39.3573 40.5586 39.8425 40.7498C40.3689 40.9571 40.877 41.1573 41.3472 40.697C41.4957 40.557 41.6819 40.5553 41.8675 40.5536C41.9349 40.553 42.0023 40.5523 42.0678 40.5451C41.9215 39.7609 41.0961 39.7702 40.2582 39.7795C39.2891 39.7903 38.3033 39.8014 38.3325 38.5851C39.233 37.9699 39.2413 36.9021 39.2492 35.8929C39.2511 35.6493 39.2529 35.4091 39.2673 35.1795C39.9296 35.5489 40.6302 35.8376 41.3264 36.1246C41.9813 36.3945 42.6323 36.6628 43.244 36.9953C43.8828 38.024 44.8799 39.3878 46.2081 39.2982C46.2431 39.193 46.2743 39.1033 46.3132 38.9981C46.3898 39.0115 46.4706 39.032 46.5529 39.0528C46.9014 39.1412 47.2748 39.2358 47.4544 38.8228ZM73.48 27.1315C74.249 27.899 75.2921 28.3302 76.3797 28.3302C77.4673 28.3302 78.5103 27.899 79.2794 27.1315C80.0484 26.364 80.4804 25.323 80.4804 24.2375C80.4804 23.1521 80.0484 22.1111 79.2794 21.3436C78.5103 20.5761 77.4673 20.1449 76.3797 20.1449C75.871 20.1449 75.3721 20.2392 74.9064 20.4181L72.5533 16.9819L70.9152 18.1046L73.28 21.558C72.6365 22.2995 72.2789 23.2501 72.2789 24.2375C72.2789 25.323 72.711 26.364 73.48 27.1315ZM66.1213 16.0159C66.6967 16.3004 67.331 16.446 67.9731 16.441C68.8492 16.4343 69.7002 16.1477 70.4012 15.6232C71.1022 15.0987 71.6165 14.3639 71.8687 13.5265C72.1209 12.6891 72.0977 11.7931 71.8025 10.9698C71.5074 10.1465 70.9558 9.43917 70.2285 8.95149C69.6956 8.59407 69.0859 8.36657 68.4487 8.28729C67.8115 8.20802 67.1646 8.27919 66.56 8.49509C65.9554 8.71098 65.4101 9.06555 64.9679 9.53025C64.5257 9.99495 64.1991 10.5568 64.0142 11.1705C63.8294 11.7843 63.7916 12.4327 63.9038 13.0637C64.016 13.6947 64.2751 14.2906 64.6603 14.8034C65.0455 15.3161 65.5459 15.7315 66.1213 16.0159ZM66.1213 39.7813C66.6967 40.0657 67.331 40.2113 67.9731 40.2064C68.8492 40.1996 69.7002 39.913 70.4012 39.3885C71.1022 38.864 71.6165 38.1292 71.8687 37.2918C72.1209 36.4544 72.0977 35.5584 71.8025 34.7351C71.5074 33.9118 70.9558 33.2045 70.2285 32.7168C69.6956 32.3594 69.0859 32.1319 68.4487 32.0526C67.8115 31.9734 67.1646 32.0445 66.56 32.2604C65.9554 32.4763 65.4101 32.8309 64.9679 33.2956C64.5257 33.7603 64.1991 34.3221 64.0142 34.9359C63.8294 35.5496 63.7916 36.1981 63.9038 36.8291C64.016 37.4601 64.2751 38.0559 64.6603 38.5687C65.0455 39.0815 65.5459 39.4968 66.1213 39.7813ZM69.8934 25.2555V23.2207H63.6171C63.4592 22.6038 63.1581 22.0323 62.738 21.5523L65.0993 18.0525L63.382 16.9131L61.0207 20.4128C60.5879 20.2564 60.1317 20.1738 59.6714 20.1686C58.5869 20.1686 57.5469 20.5974 56.7801 21.3606C56.0133 22.1237 55.5825 23.1588 55.5825 24.2381C55.5825 25.3174 56.0133 26.3525 56.7801 27.1156C57.5469 27.8788 58.5869 28.3076 59.6714 28.3076C60.1317 28.3024 60.5879 28.2198 61.0207 28.0634L63.382 31.5631L65.0788 30.4237L62.738 26.9239C63.1581 26.4439 63.4592 25.8724 63.6171 25.2555H69.8934Z",fill:"#264849"})})}var y=r(66202);function v(e){let{className:t,...r}=e;return(0,a.jsx)(y.b,{"data-slot":"label",className:d("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}var j=r(85800),b=r(79167),w=r(36983);let N=l.forwardRef((e,t)=>{let{className:r,...s}=e,[n,i]=l.useState(!1);return(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(p,{type:n?"text":"password",className:d("hide-password-toggle pr-10",r),ref:t,...s}),(0,a.jsxs)(f,{type:"button",variant:"ghost",size:"sm",className:"absolute top-0 right-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(e=>!e),children:[n?(0,a.jsx)(b.A,{className:"h-4 w-4","aria-hidden":"true"}):(0,a.jsx)(w.A,{className:"h-4 w-4","aria-hidden":"true"}),(0,a.jsx)("span",{className:"sr-only",children:n?"Hide password":"Show password"})]}),(0,a.jsx)("style",{children:"\n					.hide-password-toggle::-ms-reveal,\n					.hide-password-toggle::-ms-clear {\n						visibility: hidden;\n						pointer-events: none;\n						display: none;\n					}\n				"})]})});function C(){try{var e;return null!=(e=window.localStorage.getItem("lg:chat:apiKey"))?e:null}catch(e){}return null}N.displayName="PasswordInput";var A=r(49841),k=r(87316);let S=(0,l.createContext)(void 0);function _(e){let{children:t}=e,[r]=(0,m.ZA)("apiUrl",{defaultValue:"http://10.206.26.122:8123"}),[s]=(0,m.ZA)("assistantId",{defaultValue:"VSDA Agent"}),[n,i]=(0,l.useState)([]),[o,d]=(0,l.useState)(!1),c=(0,l.useCallback)(async()=>{var e,t;if(!r||!s)return[];let a=(t=null!=(e=C())?e:void 0,new k.Kj({apiKey:t,apiUrl:r}));return await a.threads.search({metadata:{...(0,A.A)(s)?{assistant_id:s}:{graph_id:s}},limit:100})},[r,s]);return(0,a.jsx)(S.Provider,{value:{getThreads:c,threads:n,setThreads:i,threadsLoading:o,setThreadsLoading:d},children:t})}function E(){let e=(0,l.useContext)(S);if(void 0===e)throw Error("useThreads must be used within a ThreadProvider");return e}var R=r(37684);let P=c.E,L=(0,l.createContext)(void 0);async function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4e3;return new Promise(t=>setTimeout(t,e))}async function z(e,t){try{return(await fetch("".concat(e,"/info"),{...t&&{headers:{"X-Api-Key":t}}})).ok}catch(e){return console.error(e),!1}}let D=e=>{let{children:t,apiKey:r,apiUrl:s,assistantId:n}=e,[i,o]=(0,m.ZA)("threadId"),{getThreads:d,setThreads:c}=E(),p=P({apiUrl:s,apiKey:null!=r?r:void 0,assistantId:n,threadId:null!=i?i:null,fetchStateHistory:!0,onCustomEvent:(e,t)=>{((0,u.M)(e)||(0,u.oy)(e))&&t.mutate(t=>{var r;let a=(0,u.Aq)(null!=(r=t.ui)?r:[],e);return{...t,ui:a}})},onThreadId:e=>{o(e),T().then(()=>d().then(c).catch(console.error))}});return(0,l.useEffect)(()=>{z(s,r).then(e=>{e||R.oR.error("Failed to connect to LangGraph server",{description:()=>(0,a.jsxs)("p",{children:["Please ensure your graph is running at ",(0,a.jsx)("code",{children:s})," and your API key is correctly set (if connecting to a deployed graph)."]}),duration:1e4,richColors:!0,closeButton:!0})})},[r,s]),(0,a.jsx)(L.Provider,{value:p,children:t})},O=e=>{let{children:t}=e,r="http://10.206.26.122:8123",s="VSDA Agent",[n,i]=(0,m.ZA)("apiUrl",{defaultValue:r||""}),[o,d]=(0,m.ZA)("assistantId",{defaultValue:s||""}),[c,u]=(0,l.useState)(()=>C()||""),x=e=>{window.localStorage.setItem("lg:chat:apiKey",e),u(e)},h=o||s;return(n||r)&&h?(0,a.jsx)(D,{apiKey:c,apiUrl:n,assistantId:o,children:t}):(0,a.jsx)("div",{className:"flex min-h-screen w-full items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"animate-in fade-in-0 zoom-in-95 bg-background flex max-w-3xl flex-col rounded-lg border shadow-lg",children:[(0,a.jsxs)("div",{className:"mt-14 flex flex-col gap-2 border-b p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,a.jsx)(g,{className:"h-7"}),(0,a.jsx)("h1",{className:"text-xl font-semibold tracking-tight",children:"VSDA Agent Chat"})]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Welcome to VSDA Agent Chat! Before you get started, you need to enter the URL of the deployment and the assistant / graph ID."})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=e.target,r=new FormData(t),a=r.get("apiUrl"),s=r.get("assistantId"),l=r.get("apiKey");i(a),x(l),d(s),t.reset()},className:"bg-muted/50 flex flex-col gap-6 p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)(v,{htmlFor:"apiUrl",children:["Deployment URL",(0,a.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"This is the URL of your LangGraph deployment. Can be a local, or production deployment."}),(0,a.jsx)(p,{id:"apiUrl",name:"apiUrl",className:"bg-background",defaultValue:n||"http://localhost:2024",required:!0})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)(v,{htmlFor:"assistantId",children:["Assistant / Graph ID",(0,a.jsx)("span",{className:"text-rose-500",children:"*"})]}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"This is the ID of the graph (can be the graph name), or assistant to fetch threads from, and invoke when actions are taken."}),(0,a.jsx)(p,{id:"assistantId",name:"assistantId",className:"bg-background",defaultValue:o||"agent",required:!0})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(v,{htmlFor:"apiKey",children:"LangSmith API Key"}),(0,a.jsxs)("p",{className:"text-muted-foreground text-sm",children:["This is ",(0,a.jsx)("strong",{children:"NOT"})," required if using a local LangGraph server. This value is stored in your browser's local storage and is only used to authenticate requests sent to your LangGraph server."]}),(0,a.jsx)(N,{id:"apiKey",name:"apiKey",defaultValue:null!=c?c:"",className:"bg-background",placeholder:"lsv2_pt_..."})]}),(0,a.jsx)("div",{className:"mt-2 flex justify-end",children:(0,a.jsxs)(f,{type:"submit",size:"lg",children:["Continue",(0,a.jsx)(j.A,{className:"size-5"})]})})]})]})})},M=()=>{let e=(0,l.useContext)(L);if(void 0===e)throw Error("useStreamContext must be used within a StreamProvider");return e};var I=r(97453);function F(e){return"string"==typeof e?e:e.filter(e=>"text"===e.type).map(e=>e.text).join(" ")}var B=r(60334),U=r(5031),H=r(55341),K=r(94574),J=r(97182),V=r(24479),Z=r(12463),q=r(78447),G=r(90890);function W(e){let{delayDuration:t=0,...r}=e;return(0,a.jsx)(G.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...r})}function Y(e){let{...t}=e;return(0,a.jsx)(W,{children:(0,a.jsx)(G.bL,{"data-slot":"tooltip",...t})})}function $(e){let{...t}=e;return(0,a.jsx)(G.l9,{"data-slot":"tooltip-trigger",...t})}function X(e){let{className:t,sideOffset:r=0,children:s,...l}=e;return(0,a.jsx)(G.ZL,{children:(0,a.jsxs)(G.UC,{"data-slot":"tooltip-content",sideOffset:r,className:d("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance",t),...l,children:[s,(0,a.jsx)(G.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}let Q=(0,l.forwardRef)((e,t)=>{let{children:r,tooltip:s,side:l="bottom",className:n,...i}=e;return(0,a.jsx)(W,{children:(0,a.jsxs)(Y,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"icon",...i,className:d("size-6 p-1",n),ref:t,children:[r,(0,a.jsx)("span",{className:"sr-only",children:s})]})}),(0,a.jsx)(X,{side:l,children:s})]})})});Q.displayName="TooltipIconButton";var ee=r(55935);function et(e){let{content:t,disabled:r}=e,[s,i]=(0,l.useState)(!1),o=e=>{e.stopPropagation(),navigator.clipboard.writeText(t),i(!0),setTimeout(()=>i(!1),2e3)};return(0,a.jsx)(Q,{onClick:e=>o(e),variant:"ghost",tooltip:"Copy content",disabled:r,children:(0,a.jsx)(ee.N,{mode:"wait",initial:!1,children:s?(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:(0,a.jsx)(B.A,{className:"text-green-500"})},"check"):(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:(0,a.jsx)(U.A,{})},"copy")})})}function er(e){let{branch:t,branchOptions:r,onSelect:s,isLoading:l}=e;if(!r||!t)return null;let n=r.indexOf(t);return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f,{variant:"ghost",size:"icon",className:"size-6 p-1",onClick:()=>{let e=r[n-1];e&&s(e)},disabled:l,children:(0,a.jsx)(H.A,{})}),(0,a.jsxs)("span",{className:"text-sm",children:[n+1," / ",r.length]}),(0,a.jsx)(f,{variant:"ghost",size:"icon",className:"size-6 p-1",onClick:()=>{let e=r[n+1];e&&s(e)},disabled:l,children:(0,a.jsx)(K.A,{})})]})}function ea(e){let{content:t,isHumanMessage:r,isAiMessage:s,isEditing:l,setIsEditing:n,handleSubmitEdit:i,handleRegenerate:o,isLoading:d}=e;if(r&&s)throw Error("Can only set one of isHumanMessage or isAiMessage to true, not both.");if(!r&&!s)throw Error("One of isHumanMessage or isAiMessage must be set to true.");if(r&&(void 0===l||void 0===n||void 0===i))throw Error("If isHumanMessage is true, all of isEditing, setIsEditing, and handleSubmitEdit must be set.");return r&&l&&n&&i?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Q,{disabled:d,tooltip:"Cancel edit",variant:"ghost",onClick:()=>{n(!1)},children:(0,a.jsx)(J.A,{})}),(0,a.jsx)(Q,{disabled:d,tooltip:"Submit",variant:"secondary",onClick:i,children:(0,a.jsx)(V.A,{})})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(et,{content:t,disabled:d}),s&&!!o&&(0,a.jsx)(Q,{disabled:d,tooltip:"Refresh",variant:"ghost",onClick:o,children:(0,a.jsx)(Z.A,{})}),r&&void 0!==l&&!!n&&!!i&&(0,a.jsx)(Q,{disabled:d,tooltip:"Edit",variant:"ghost",onClick:()=>{null==n||n(!0)},children:(0,a.jsx)(q.A,{})})]})}r(87527);var es=r(68475),el=r(61381),en=r(99937),ei=r(28436),eo=r(26942),ed=r(21131),ec=r(18986),eu=r(3697),em=r(19249);ed.A.registerLanguage("js",ec.A),ed.A.registerLanguage("jsx",ec.A),ed.A.registerLanguage("ts",ec.A),ed.A.registerLanguage("tsx",ec.A),ed.A.registerLanguage("python",eu.A);let ep=e=>{let{children:t,language:r,className:s}=e;return(0,a.jsx)(ed.A,{language:r,style:em.hY,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},className:s,children:t})};r(69645);let ex=function(){let{copiedDuration:e=3e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,l.useState)(!1);return{isCopied:t,copyToClipboard:t=>{t&&navigator.clipboard.writeText(t).then(()=>{r(!0),setTimeout(()=>r(!1),e)})}}},eh=e=>{let{language:t,code:r}=e,{isCopied:s,copyToClipboard:l}=ex();return(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-t-lg bg-zinc-900 px-4 py-2 text-sm font-semibold text-white",children:[(0,a.jsx)("span",{className:"lowercase [&>span]:text-xs",children:t}),(0,a.jsxs)(Q,{tooltip:"Copy",onClick:()=>{r&&!s&&l(r)},children:[!s&&(0,a.jsx)(U.A,{}),s&&(0,a.jsx)(eo.A,{})]})]})},ef={h1:e=>{let{className:t,...r}=e;return(0,a.jsx)("h1",{className:d("mb-8 scroll-m-20 text-4xl font-extrabold tracking-tight last:mb-0",t),...r})},h2:e=>{let{className:t,...r}=e;return(0,a.jsx)("h2",{className:d("mt-8 mb-4 scroll-m-20 text-3xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...r})},h3:e=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{className:d("mt-6 mb-4 scroll-m-20 text-2xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...r})},h4:e=>{let{className:t,...r}=e;return(0,a.jsx)("h4",{className:d("mt-6 mb-4 scroll-m-20 text-xl font-semibold tracking-tight first:mt-0 last:mb-0",t),...r})},h5:e=>{let{className:t,...r}=e;return(0,a.jsx)("h5",{className:d("my-4 text-lg font-semibold first:mt-0 last:mb-0",t),...r})},h6:e=>{let{className:t,...r}=e;return(0,a.jsx)("h6",{className:d("my-4 font-semibold first:mt-0 last:mb-0",t),...r})},p:e=>{let{className:t,...r}=e;return(0,a.jsx)("p",{className:d("mt-5 mb-5 leading-7 first:mt-0 last:mb-0",t),...r})},a:e=>{let{className:t,...r}=e;return(0,a.jsx)("a",{className:d("text-primary font-medium underline underline-offset-4",t),...r})},blockquote:e=>{let{className:t,...r}=e;return(0,a.jsx)("blockquote",{className:d("border-l-2 pl-6 italic",t),...r})},ul:e=>{let{className:t,...r}=e;return(0,a.jsx)("ul",{className:d("my-5 ml-6 list-disc [&>li]:mt-2",t),...r})},ol:e=>{let{className:t,...r}=e;return(0,a.jsx)("ol",{className:d("my-5 ml-6 list-decimal [&>li]:mt-2",t),...r})},hr:e=>{let{className:t,...r}=e;return(0,a.jsx)("hr",{className:d("my-5 border-b",t),...r})},table:e=>{let{className:t,...r}=e;return(0,a.jsx)("table",{className:d("my-5 w-full border-separate border-spacing-0 overflow-y-auto",t),...r})},th:e=>{let{className:t,...r}=e;return(0,a.jsx)("th",{className:d("bg-muted px-4 py-2 text-left font-bold first:rounded-tl-lg last:rounded-tr-lg [&[align=center]]:text-center [&[align=right]]:text-right",t),...r})},td:e=>{let{className:t,...r}=e;return(0,a.jsx)("td",{className:d("border-b border-l px-4 py-2 text-left last:border-r [&[align=center]]:text-center [&[align=right]]:text-right",t),...r})},tr:e=>{let{className:t,...r}=e;return(0,a.jsx)("tr",{className:d("m-0 border-b p-0 first:border-t [&:last-child>td:first-child]:rounded-bl-lg [&:last-child>td:last-child]:rounded-br-lg",t),...r})},sup:e=>{let{className:t,...r}=e;return(0,a.jsx)("sup",{className:d("[&>a]:text-xs [&>a]:no-underline",t),...r})},pre:e=>{let{className:t,...r}=e;return(0,a.jsx)("pre",{className:d("max-w-4xl overflow-x-auto rounded-lg bg-black text-white",t),...r})},code:e=>{let{className:t,children:r,...s}=e,l=/language-(\w+)/.exec(t||"");if(l){let e=l[1],s=String(r).replace(/\n$/,"");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh,{language:e,code:s}),(0,a.jsx)(ep,{language:e,className:t,children:s})]})}return(0,a.jsx)("code",{className:d("rounded font-semibold",t),...s,children:r})}},eg=(0,l.memo)(e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"markdown-content",children:(0,a.jsx)(es.oz,{remarkPlugins:[el.A,ei.A],rehypePlugins:[en.A],components:ef,children:t})})});var ey=r(40637),ev=r(90396);function ej(e){return Array.isArray(e)||"object"==typeof e&&null!==e}function eb(e){let{toolCalls:t}=e;return t&&0!==t.length?(0,a.jsx)("div",{className:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",children:t.map((e,t)=>{let r=e.args,s=Object.keys(r).length>0;return(0,a.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-2",children:(0,a.jsxs)("h3",{className:"font-medium text-gray-900",children:[e.name,e.id&&(0,a.jsx)("code",{className:"ml-2 rounded bg-gray-100 px-2 py-1 text-sm",children:e.id})]})}),s?(0,a.jsx)("table",{className:"min-w-full divide-y divide-gray-200",children:(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:Object.entries(r).map((e,t)=>{let[r,s]=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium whitespace-nowrap text-gray-900",children:r}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:ej(s)?(0,a.jsx)("code",{className:"rounded bg-gray-50 px-2 py-1 font-mono text-sm break-all",children:JSON.stringify(s,null,2)}):String(s)})]},t)})})}):(0,a.jsx)("code",{className:"block p-3 text-sm",children:"{}"})]},t)})}):null}function ew(e){let t,{message:r}=e,[s,i]=(0,l.useState)(!1),o=!1;try{"string"==typeof r.content&&(t=JSON.parse(r.content),o=ej(t))}catch(e){t=r.content}let d=o?JSON.stringify(t,null,2):String(r.content),c=d.split("\n"),u=c.length>4||d.length>500,m=u&&!s?d.length>500?d.slice(0,500)+"...":c.slice(0,4).join("\n")+"\n...":d;return(0,a.jsx)("div",{className:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",children:(0,a.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-2",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[r.name?(0,a.jsxs)("h3",{className:"font-medium text-gray-900",children:["Tool Result:"," ",(0,a.jsx)("code",{className:"rounded bg-gray-100 px-2 py-1",children:r.name})]}):(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Tool Result"}),r.tool_call_id&&(0,a.jsx)("code",{className:"ml-2 rounded bg-gray-100 px-2 py-1 text-sm",children:r.tool_call_id})]})}),(0,a.jsxs)(n.P.div,{className:"min-w-full bg-gray-100",initial:!1,animate:{height:"auto"},transition:{duration:.3},children:[(0,a.jsx)("div",{className:"p-3",children:(0,a.jsx)(ee.N,{mode:"wait",initial:!1,children:(0,a.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:o?(0,a.jsx)("table",{className:"min-w-full divide-y divide-gray-200",children:(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:(Array.isArray(t)?s?t:t.slice(0,5):Object.entries(t)).map((e,r)=>{let[s,l]=Array.isArray(t)?[r,e]:[e[0],e[1]];return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium whitespace-nowrap text-gray-900",children:s}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:ej(l)?(0,a.jsx)("code",{className:"rounded bg-gray-50 px-2 py-1 font-mono text-sm break-all",children:JSON.stringify(l,null,2)}):String(l)})]},r)})})}):(0,a.jsx)("code",{className:"block text-sm",children:m})},s?"expanded":"collapsed")})}),(u&&!o||o&&Array.isArray(t)&&t.length>5)&&(0,a.jsx)(n.P.button,{onClick:()=>i(!s),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-gray-200 py-2 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:s?(0,a.jsx)(ey.A,{}):(0,a.jsx)(ev.A,{})})]})]})})}function eN(e){let t=Array.isArray(e)?e[0]:e;if(!t||"object"!=typeof t||!t.value||"object"!=typeof t.value)return!1;let{action_requests:r,review_configs:a}=t.value;if(!Array.isArray(r)||0===r.length||!Array.isArray(a)||0===a.length)return!1;let s=r.every(e=>e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name&&"args"in e&&null!==e.args&&"object"==typeof e.args),l=a.every(e=>e&&"object"==typeof e&&"action_name"in e&&"string"==typeof e.action_name&&"allowed_decisions"in e&&Array.isArray(e.allowed_decisions));return s&&l}var eC=r(93735),eA=r(33661),ek=r(736),eS=r(43010),e_=r(16185),eE=r.n(e_);function eR(e){return eE()(e.replace(/_/g," "))}function eP(e){try{return Object.prototype.toString.call(e),(0,eS.GP)(new Date(e),"MM/dd/yyyy hh:mm a")}catch(e){}}function eL(e,t){if(!e.length)return{error:"Please enter a response."};let r=e.find(e=>e.type===t);if(!r)return{error:"No response selected."};if("approve"===r.type)return{decision:{type:"approve"}};if("reject"===r.type){var a;let e=null==(a=r.message)?void 0:a.trim();return e?{decision:{type:"reject",message:e}}:{error:"Please provide a rejection reason."}}return"edit"===r.type?r.acceptAllowed&&!r.editsMade?{decision:{type:"approve"}}:{decision:{type:"edit",edited_action:r.edited_action}}:{error:"Unsupported response type."}}function eT(e){let{toolCall:t}=e;return(0,a.jsx)("div",{className:"max-w-full min-w-[300px] overflow-hidden rounded-lg border",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:(0,a.jsx)("th",{className:"bg-gray-100 px-2 py-0 text-left text-sm",colSpan:2,children:t.name})})}),(0,a.jsx)("tbody",{children:Object.entries(t.args).map(e=>{let[t,r]=e,s="";["string","number"].includes(typeof r)&&(s=r.toString());let l=eP(r);l&&(s=l);try{s=s||JSON.stringify(r,null)}catch(e){s=""}return(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"w-1/3 px-2 py-1 text-xs font-medium",children:t}),(0,a.jsx)("td",{className:"px-2 py-1 font-mono text-xs",children:s})]},t)})})]})})}let ez=e=>{let t="";switch("type"in e?t=e.type:"getType"in e&&(t=e.getType()),t){case"human":return"User";case"ai":return"Assistant";case"tool":return"Tool";case"System":return"System";default:return""}};function eD(e){let{messages:t}=e;return(0,a.jsx)("div",{className:"flex w-full flex-col gap-1",children:t.map((e,t)=>{var r;let s=ez(e),l="string"==typeof e.content?e.content:JSON.stringify(e.content,null);return(0,a.jsxs)("div",{className:"ml-2 flex w-full flex-col gap-[2px]",children:[(0,a.jsxs)("p",{className:"font-medium text-gray-700",children:[s,":"]}),l&&(0,a.jsx)(eg,{children:l}),"tool_calls"in e&&e.tool_calls?(0,a.jsx)("div",{className:"flex w-full flex-col items-start gap-1",children:e.tool_calls.map((e,t)=>{var r;return(0,a.jsx)(eT,{toolCall:e},null!=(r=e.id)?r:"tool-call-".concat(t))})}):null]},null!=(r=e.id)?r:"message-".concat(t))})})}function eO(e){let t=eP(e.value);if(t)return(0,a.jsx)("p",{className:"font-light text-gray-600",children:t});if(["string","number"].includes(typeof e.value))return(0,a.jsx)(eg,{children:e.value});if("boolean"==typeof e.value)return(0,a.jsx)(eg,{children:JSON.stringify(e.value)});if(null==e.value)return(0,a.jsx)("p",{className:"font-light whitespace-pre-wrap text-gray-600",children:"null"});if(Array.isArray(e.value)){var r;if(e.value.length>0&&((r=e.value).every(ek.ny)||Array.isArray(r)&&r.every(e=>"object"==typeof e&&"id"in e&&"type"in e&&"content"in e&&"additional_kwargs"in e)))return(0,a.jsx)(eD,{messages:e.value});let t=e.value;return(0,a.jsxs)("div",{className:"flex w-full flex-row items-start justify-start gap-1",children:[(0,a.jsx)("span",{className:"font-normal text-black",children:"["}),t.map((e,r)=>{let s=function(e){if((0,ek.ny)(e)){let t="string"==typeof e.content?e.content:JSON.stringify(e.content,null),r="";if("tool_calls"in e&&(r=JSON.stringify(e.tool_calls,null)),"type"in e)return"".concat(e.type,":").concat(t?" ".concat(t):"").concat(r?" - Tool calls: ".concat(r):"");if("getType"in e)return"".concat(e.getType(),":").concat(t?" ".concat(t):"").concat(r?" - Tool calls: ".concat(r):"")}else if("object"==typeof e&&e&&"type"in e&&"content"in e){let t="string"==typeof e.content?e.content:JSON.stringify(e.content,null),r="";return"tool_calls"in e&&(r=JSON.stringify(e.tool_calls,null)),"".concat(e.type,":").concat(t?" ".concat(t):"").concat(r?" - Tool calls: ".concat(r):"")}return"object"==typeof e?JSON.stringify(e,null):e}(e);return(0,a.jsxs)("div",{className:"flex w-full flex-row items-start whitespace-pre-wrap",children:[(0,a.jsx)(eO,{value:s}),r<(null==t?void 0:t.length)-1&&(0,a.jsx)("span",{className:"font-normal text-black",children:",\xa0"})]},"state-view-".concat(r))}),(0,a.jsx)("span",{className:"font-normal text-black",children:"]"})]})}if("object"==typeof e.value)return 0===Object.keys(e.value).length?(0,a.jsx)("p",{className:"font-light text-gray-600",children:"{}"}):(0,a.jsxs)("div",{className:"relative ml-6 flex w-full flex-col items-start justify-start gap-1",children:[(0,a.jsx)("div",{className:"absolute top-0 left-[-24px] h-full w-[1px] bg-gray-200"}),Object.entries(e.value).map((t,r)=>{let[s,l]=t;return(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("div",{className:"absolute top-[10px] left-[-20px] h-[1px] w-[18px] bg-gray-200"}),(0,a.jsx)(eI,{expanded:e.expanded,keyName:s,value:l})]},"state-view-object-".concat(s,"-").concat(r))})]})}function eM(e){let{onClick:t}=e;return(0,a.jsx)("span",{onClick:t,className:d("rounded-md p-[2px] font-mono text-[10px] leading-3","bg-gray-50 text-gray-600 hover:bg-gray-100 hover:text-gray-800","cursor-pointer transition-colors ease-in-out","inline-block -translate-y-[2px]"),children:"{...}"})}function eI(e){let[t,r]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{null!=e.expanded&&r(e.expanded)},[e.expanded]),(0,a.jsxs)("div",{className:"relative flex flex-row items-start justify-start gap-2 text-sm",children:[(0,a.jsx)(n.P.div,{initial:!1,animate:{rotate:90*!!t},transition:{duration:.2},children:(0,a.jsx)("div",{onClick:()=>r(e=>!e),className:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-md text-gray-500 transition-colors ease-in-out hover:bg-gray-100 hover:text-black",children:(0,a.jsx)(K.A,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-1",children:[(0,a.jsxs)("p",{className:"font-normal text-black",children:[eR(e.keyName)," ",!t&&(0,a.jsx)(eM,{onClick:()=>r(e=>!e)})]}),(0,a.jsx)(n.P.div,{initial:!1,animate:{height:t?"auto":0,opacity:+!!t},transition:{duration:.2,ease:"easeInOut"},style:{overflow:"hidden"},className:"relative w-full",children:(0,a.jsx)(eO,{expanded:e.expanded,value:e.value})})]})]})}function eF(e){let{handleShowSidePanel:t,view:r,values:s,description:n}=e,[i,o]=(0,l.useState)(!1);return s?(0,a.jsxs)("div",{className:d("flex min-w-full flex-row gap-0","state"===r&&"border-t-[1px] border-gray-100 lg:border-t-[0px] lg:border-l-[1px]"),children:["description"===r&&(0,a.jsx)("div",{className:"pt-6 pb-2",children:(0,a.jsx)(eg,{children:null!=n?n:"No description provided"})}),"state"===r&&(0,a.jsx)("div",{className:"flex flex-col items-start justify-start gap-1",children:Object.entries(s).map((e,t)=>{let[r,s]=e;return(0,a.jsx)(eI,{expanded:i,keyName:r,value:s},"state-view-".concat(r,"-").concat(t))})}),(0,a.jsxs)("div",{className:"flex items-start justify-end gap-2",children:["state"===r&&(0,a.jsx)(f,{onClick:()=>o(e=>!e),variant:"ghost",className:"text-gray-600",size:"sm",children:i?(0,a.jsx)(eC.A,{className:"h-4 w-4"}):(0,a.jsx)(eA.A,{className:"h-4 w-4"})}),(0,a.jsx)(f,{onClick:()=>t(!1,!1),variant:"ghost",className:"text-gray-600",size:"sm",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]})]}):(0,a.jsx)("div",{children:"No state found"})}function eB(e){let{threadId:t,showUUID:r=!1}=e,[s,i]=l.useState(!1),o=e=>{e.stopPropagation(),navigator.clipboard.writeText(t),i(!0),setTimeout(()=>i(!1),2e3)};return(0,a.jsxs)(Q,{onClick:e=>o(e),variant:"ghost",tooltip:"Copy thread ID",className:"flex w-fit flex-grow-0 cursor-pointer items-center gap-1 rounded-md border-[1px] border-gray-200 p-1 hover:bg-gray-50/90",children:[(0,a.jsx)("p",{className:"font-mono text-xs",children:r?t:"ID"}),(0,a.jsx)(ee.N,{mode:"wait",initial:!1,children:s?(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:(0,a.jsx)(B.A,{className:"h-3 max-h-3 w-3 max-w-3 text-green-500"})},"check"):(0,a.jsx)(n.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.15},children:(0,a.jsx)(U.A,{className:"h-3 max-h-3 w-3 max-w-3 text-gray-500"})},"copy")})]})}function eU(e){let{className:t,...r}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:d("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}var eH=r(69195);function eK(e){let{className:t,orientation:r="horizontal",decorative:s=!0,...l}=e;return(0,a.jsx)(eH.b,{"data-slot":"separator-root",decorative:s,orientation:r,className:d("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...l})}var eJ=r(83907);function eV(e){let{handleReset:t}=e;return(0,a.jsxs)(f,{onClick:t,variant:"ghost",className:"flex items-center justify-center gap-2 text-gray-500 hover:text-red-500",children:[(0,a.jsx)(eJ.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Reset"})]})}function eZ(e){let{args:t}=e;return(0,a.jsx)("div",{className:"flex w-full flex-col items-start gap-6",children:Object.entries(t).map(e=>{let[t,r]=e,s="string"==typeof r||"number"==typeof r?r.toString():JSON.stringify(r,null);return(0,a.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,a.jsx)("p",{className:"text-sm leading-[18px] text-wrap text-gray-600",children:eR(t)}),(0,a.jsx)("span",{className:"w-full max-w-full rounded-xl bg-zinc-100 p-3 text-[13px] leading-[18px] text-black",children:(0,a.jsx)(eg,{children:s})})]},"args-".concat(t))})})}function eq(e){let{isLoading:t,actionRequestArgs:r,handleSubmit:s}=e;return(0,a.jsxs)("div",{className:"flex w-full flex-col items-start gap-4 rounded-lg border border-gray-300 p-6",children:[Object.keys(r).length>0&&(0,a.jsx)(eZ,{args:r}),(0,a.jsx)(f,{variant:"brand",disabled:t,onClick:s,className:"w-full",children:"Approve"})]})}let eG=l.memo(function(e){let{humanResponse:t,isLoading:r,initialValues:s,onEditChange:n,handleSubmit:i,actionArgs:o}=e,d=l.useRef({}),c=t.find(e=>"edit"===e.type),u=t.find(e=>"approve"===e.type);if(!c||"edit"!==c.type||"object"!=typeof c.edited_action||!c.edited_action)return u?(0,a.jsx)(eq,{actionRequestArgs:o,isLoading:r,handleSubmit:i}):null;let m=c.acceptAllowed?"Edit/Approve":"Edit",p=c.acceptAllowed&&!c.editsMade?"Approve":"Submit",x=e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),i(e))};return(0,a.jsxs)("div",{className:"flex w-full min-w-full flex-col items-start gap-4 rounded-lg border border-gray-300 p-6",children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)("p",{className:"text-base font-semibold text-black",children:m}),(0,a.jsx)(eV,{handleReset:()=>{var e;if(!(null==(e=c.edited_action)?void 0:e.args))return;let t=[],r=[];Object.entries(s).forEach(e=>{let[a,s]=e;if(a in c.edited_action.args){let e="string"==typeof s||"number"==typeof s?s.toString():JSON.stringify(s,null);t.push(a),r.push(e)}}),t.length>0&&r.length>0&&n(r,c,t)}})]}),Object.entries(c.edited_action.args).map((e,t)=>{let[s,l]=e,i="string"==typeof l||"number"==typeof l?l.toString():JSON.stringify(l,null);return void 0===d.current[s]&&(d.current[s]=i.length?Math.max(i.length/30,7):3),(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-start gap-1 px-[1px]",children:(0,a.jsxs)("div",{className:"flex w-full flex-col items-start gap-[6px]",children:[(0,a.jsx)("p",{className:"min-w-fit text-sm font-medium",children:eR(s)}),(0,a.jsx)(eU,{disabled:r,className:"h-full w-full max-w-full",value:i,onChange:e=>n(e.target.value,c,s),onKeyDown:x,rows:d.current[s]||8})]})},"allow-edit-args--".concat(s,"-").concat(t))}),(0,a.jsx)("div",{className:"flex w-full items-center justify-end gap-2",children:(0,a.jsx)(f,{variant:"brand",disabled:r,onClick:i,children:p})})]})}),eW=l.memo(function(e){var t;let{humanResponse:r,isLoading:s,onChange:l,handleSubmit:n,showArgs:i,actionArgs:o}=e,d=r.find(e=>"reject"===e.type);return d?(0,a.jsxs)("div",{className:"flex w-full max-w-full flex-col items-start gap-4 rounded-xl border border-gray-300 p-6",children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)("p",{className:"text-base font-semibold text-black",children:"Reject"}),(0,a.jsx)(eV,{handleReset:()=>l("",d)})]}),i&&(0,a.jsx)(eZ,{args:o}),(0,a.jsxs)("div",{className:"flex w-full flex-col items-start gap-[6px]",children:[(0,a.jsx)("p",{className:"min-w-fit text-sm font-medium",children:"Reason"}),(0,a.jsx)(eU,{disabled:s,className:"w-full max-w-full",value:null!=(t=d.message)?t:"",onChange:e=>l(e.target.value,d),onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),n(e))},rows:4,placeholder:"Share feedback with the agent..."})]}),(0,a.jsx)("div",{className:"flex w-full items-center justify-end gap-2",children:(0,a.jsx)(f,{variant:"brand",disabled:s,onClick:n,children:"Submit rejection"})})]}):null});function eY(e){var t,r,s,l,n;let{interruptValue:i,humanResponse:o,approveAllowed:d,hasEdited:c,hasAddedResponse:u,initialValues:m,isLoading:p,supportsMultipleMethods:x,selectedSubmitType:h,setHumanResponse:f,setSelectedSubmitType:g,setHasAddedResponse:y,setHasEdited:v,handleSubmit:j}=e,b=null!=(l=null==(r=i.review_configs)||null==(t=r[0])?void 0:t.allowed_decisions)?l:[],w=null==(s=i.action_requests)?void 0:s[0],N=null!=(n=null==w?void 0:w.args)?n:{},C=b.includes("edit"),A=b.includes("reject"),k=Object.keys(N).length>0,S=k&&!C&&!d&&A,_=k&&!S&&!C&&!d;return(0,a.jsxs)("div",{className:"flex w-full max-w-full flex-col items-start justify-start gap-2",children:[_&&(0,a.jsx)(eZ,{args:N}),(0,a.jsxs)("div",{className:"flex w-full flex-col items-stretch gap-2",children:[(0,a.jsx)(eG,{humanResponse:o,isLoading:p,initialValues:m,actionArgs:N,onEditChange:(e,t,r)=>{if(Array.isArray(e)&&!Array.isArray(r)||!Array.isArray(e)&&Array.isArray(r))return void R.oR.error("Error",{description:"Unable to update edited values.",richColors:!0,closeButton:!0});let a=!0;if("edit"===t.type&&t.edited_action){let s={...t.edited_action.args||{}};Array.isArray(e)&&Array.isArray(r)?e.forEach((e,t)=>{t<r.length&&(s[r[t]]=e)}):s[r]=e,a="object"==typeof s&&!!s&&Object.entries(s).some(e=>{let[t,r]=e,a=["string","number"].includes(typeof r)?r.toString():JSON.stringify(r,null);return m[t]!==a})}a?(g("edit"),v(!0)):(v(!1),d?g("approve"):u&&g("reject")),f(s=>{if("edit"!==t.type||!t.edited_action)return console.error("Mismatched response type for edit",t.type),s;let l=Array.isArray(e)&&Array.isArray(r)?{...t.edited_action.args,...Object.fromEntries(r.map((t,r)=>[t,e[r]]))}:{...t.edited_action.args,[r]:e},n={type:"edit",edited_action:{name:t.edited_action.name,args:l}};return s.map(e=>"edit"!==e.type?e:e.acceptAllowed?{...n,acceptAllowed:!0,editsMade:a}:n)})},handleSubmit:j}),x?(0,a.jsxs)("div",{className:"mx-auto mt-3 flex items-center gap-3",children:[(0,a.jsx)(eK,{className:"w-full"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Or"}),(0,a.jsx)(eK,{className:"w-full"})]}):null,(0,a.jsx)(eW,{humanResponse:o,isLoading:p,showArgs:S,actionArgs:N,onChange:(e,t)=>{if("reject"!==t.type)return void console.error("Mismatched response type for rejection");let r=e.trim();y(!!r),r?g("reject"):c?g("edit"):d&&g("approve"),f(t=>t.map(t=>"reject"===t.type?{type:"reject",message:e}:t))},handleSubmit:j}),p&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Submitting decision..."}),h&&x&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Currently selected: ",eR(h)]})]})]})}var e$=r(38316);function eX(e){let{handleShowState:t,handleShowDescription:r,showingState:s,showingDescription:l}=e;return(0,a.jsxs)("div",{className:"flex flex-row items-center justify-center gap-0",children:[(0,a.jsx)(f,{variant:"outline",className:d("rounded-l-md rounded-r-none border-r-[0px]",s?"text-black":"bg-white"),size:"sm",onClick:t,children:"State"}),(0,a.jsx)(f,{variant:"outline",className:d("rounded-l-none rounded-r-md border-l-[0px]",l?"text-black":"bg-white"),size:"sm",onClick:r,children:"Description"})]})}function eQ(e){var t,r;let{interrupt:s,handleShowSidePanel:n,showDescription:i,showState:o}=e,c=M(),[u]=(0,m.ZA)("threadId"),[p]=(0,m.ZA)("apiUrl"),[x,h]=(0,l.useState)(0),[g,y]=(0,l.useState)(new Map),[v,j]=(0,l.useState)(!1),b=s.value,w=(0,l.useMemo)(()=>{var e;return null!=(e=null==b?void 0:b.action_requests)?e:[]},[null==b?void 0:b.action_requests]),N=(0,l.useMemo)(()=>{var e;return null!=(e=null==b?void 0:b.review_configs)?e:[]},[null==b?void 0:b.review_configs]),C=w.length>1,A=w[x],k=null!=(t=N.find(e=>e.action_name===(null==A?void 0:A.name)))?t:N[x],S=(0,l.useMemo)(()=>A&&k?{...s,value:{action_requests:[A],review_configs:[k]}}:s,[s,A,k]),{approveAllowed:_,hasEdited:E,hasAddedResponse:P,streaming:L,supportsMultipleMethods:T,streamFinished:z,loading:D,handleSubmit:O,handleResolve:I,setSelectedSubmitType:F,setHasAddedResponse:B,setHasEdited:U,humanResponse:H,setHumanResponse:K,selectedSubmitType:J,initialHumanInterruptEditValue:V}=function(e){let{interrupt:t}=e,r=M(),[a,s]=(0,l.useState)([]),[n,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(!1),[m,p]=(0,l.useState)(),[x,h]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),[y,v]=(0,l.useState)(!1),j=(0,l.useRef)({});(0,l.useEffect)(()=>{let e=t.value;if(j.current={},!e){s([]),p(void 0),v(!1),h(!1),g(!1);return}try{let{responses:t,defaultSubmitType:r,hasApprove:a}=function(e,t){var r,a,s,l,n;let i,o=[],d=null==(r=e.action_requests)?void 0:r[0],c=null!=(l=null==(a=e.review_configs)?void 0:a.find(e=>e.action_name===(null==d?void 0:d.name)))?l:null==(s=e.review_configs)?void 0:s[0];if(!d||!c)return{responses:[],defaultSubmitType:void 0,hasApprove:!1};let u=null!=(n=c.allowed_decisions)?n:[];if(u.includes("edit")){Object.entries(d.args).forEach(e=>{let[r,a]=e,s="string"==typeof a||"number"==typeof a?a.toString():JSON.stringify(a,null);t.current={...t.current,[r]:s}});let e={name:d.name,args:{...d.args}};o.push({type:"edit",edited_action:e,acceptAllowed:u.includes("approve"),editsMade:!1})}return u.includes("approve")&&o.push({type:"approve"}),u.includes("reject")&&o.push({type:"reject",message:""}),u.includes("approve")?i="approve":u.includes("reject")?i="reject":u.includes("edit")&&(i="edit"),{responses:o,defaultSubmitType:i,hasApprove:u.includes("approve")}}(e,j);s(t),p(r),v(a),h(!1),g(!1)}catch(e){console.error("Error formatting and setting human response state",e),s([]),p(void 0),v(!1)}},[t]);let b=e=>{try{return r.submit({},{command:{resume:{decisions:e}}}),!0}catch(e){return console.error("Error sending human response",e),!1}},w=async e=>{e.preventDefault();let{decision:t,error:r}=eL(a,m);if(!t)return void R.oR.error("Error",{description:null!=r?r:"Unsupported response type.",duration:5e3,richColors:!0,closeButton:!0});if(r)return void R.oR.error("Error",{description:r,duration:5e3,richColors:!0,closeButton:!0});let s=!1;j.current={};try{if(i(!0),d(!0),!b([t])){s=!0;return}(0,R.oR)("Success",{description:"Response submitted successfully.",duration:5e3}),u(!0)}catch(e){console.error("Error sending human response",e),s=!0,"message"in e&&e.message.includes("Invalid assistant")?(0,R.oR)("Error: Invalid assistant ID",{description:"The provided assistant ID was not found in this graph. Please update the assistant ID in the settings and try again.",richColors:!0,closeButton:!0,duration:5e3}):R.oR.error("Error",{description:"Failed to submit response.",richColors:!0,closeButton:!0,duration:5e3})}finally{d(!1),i(!1),s&&u(!1)}},N=async e=>{e.preventDefault(),i(!0),j.current={};try{r.submit({},{command:{goto:e$.Kp}}),(0,R.oR)("Success",{description:"Marked thread as resolved.",duration:3e3})}catch(e){console.error("Error marking thread as resolved",e),R.oR.error("Error",{description:"Failed to mark thread as resolved.",richColors:!0,closeButton:!0,duration:3e3})}finally{i(!1)}},C=a.filter(e=>["edit","approve","reject"].includes(e.type)).length>1;return{handleSubmit:w,handleResolve:N,humanResponse:a,selectedSubmitType:m,streaming:o,streamFinished:c,loading:n,supportsMultipleMethods:C,hasEdited:x,hasAddedResponse:f,approveAllowed:y,setSelectedSubmitType:p,setHumanResponse:s,setHasAddedResponse:g,setHasEdited:h,initialHumanInterruptEditValue:j}}({interrupt:S});(0,l.useEffect)(()=>{h(0),y(new Map)},[s]);let Z=(0,l.useCallback)(()=>{if(C)try{let e=w.map(()=>({type:"approve"}));c.submit({},{command:{resume:{decisions:e}}}),(0,R.oR)("Success",{description:"All actions approved successfully.",duration:5e3})}catch(e){console.error("Error approving all actions",e),R.oR.error("Error",{description:"Failed to approve all actions.",richColors:!0,closeButton:!0,duration:5e3})}},[w,C,c]),q=(0,l.useCallback)(()=>{if(C){if(g.size!==w.length)return void R.oR.error("Error",{description:"Please address all ".concat(w.length," actions before submitting."),richColors:!0,closeButton:!0,duration:5e3});try{j(!0);let e=w.map((e,t)=>{let r=g.get(t);if(!r)throw Error("Missing decision for action ".concat(t+1));return r});c.submit({},{command:{resume:{decisions:e}}}),(0,R.oR)("Success",{description:"All actions submitted successfully.",duration:5e3}),y(new Map)}catch(e){console.error("Error submitting all actions",e),R.oR.error("Error",{description:"Failed to submit actions.",richColors:!0,closeButton:!0,duration:5e3})}finally{j(!1)}}},[w,g,C,c]),G=(0,l.useMemo)(()=>!!C&&w.every(e=>{let t=N.find(t=>t.action_name===e.name);return null==t?void 0:t.allowed_decisions.includes("approve")}),[w,N,C]),W=null!=(r=null==A?void 0:A.name)?r:"Unknown interrupt",Y=D||L||v,$=C&&g.size===w.length;if(!(s.value&&Array.isArray(s.value.action_requests)&&s.value.action_requests.length>0&&Array.isArray(s.value.review_configs)&&s.value.review_configs.length>0))return(0,a.jsx)("div",{className:"flex min-h-full w-full flex-col items-center justify-center rounded-2xl bg-gray-50/50 p-8",children:(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Unable to render interrupt. The data provided is not in the expected HITL format."})});let X=S.value;return(0,a.jsxs)("div",{className:"flex min-h-full w-full max-w-full flex-col gap-9",children:[(0,a.jsxs)("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-start gap-3",children:[(0,a.jsx)("p",{className:"text-2xl tracking-tighter text-pretty",children:C?"".concat(W," (").concat(x+1,"/").concat(w.length,")"):W}),u&&(0,a.jsx)(eB,{threadId:u})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2",children:[p&&(0,a.jsx)(f,{size:"sm",variant:"outline",className:"flex items-center gap-1 bg-white",onClick:()=>{if(!p)return void R.oR.error("Error",{description:"Please set the LangGraph deployment URL in settings.",duration:5e3,richColors:!0,closeButton:!0});let e=function(e,t){let r=new URL("https://smith.langchain.com/studio/thread"),a=e.replace(/\/$/,"");return t&&(r.pathname+="/".concat(t)),r.searchParams.append("baseUrl",a),r.toString()}(p,null!=u?u:void 0);window.open(e,"_blank")},children:"Studio"}),(0,a.jsx)(eX,{handleShowState:()=>n(!0,!1),handleShowDescription:()=>n(!1,!0),showingState:o,showingDescription:i})]})]}),(0,a.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center justify-start gap-2",children:[(0,a.jsx)(f,{variant:"outline",className:"border-gray-500 bg-white font-normal text-gray-800",onClick:I,disabled:Y,children:"Mark as Resolved"}),C&&G&&(0,a.jsx)(f,{variant:"outline",className:"border-gray-500 bg-white font-normal text-gray-800",onClick:Z,disabled:Y,children:"Approve All"})]}),C&&(0,a.jsx)("div",{className:"flex w-full items-center gap-2",children:w.map((e,t)=>{var r;let s=(r=g.get(t))?r.type:null;return(0,a.jsx)("button",{type:"button",onClick:()=>h(t),className:d("h-2 flex-1 rounded-full border transition-colors","border-gray-300 bg-gray-200","approve"===s&&"border-emerald-500 bg-emerald-200","reject"===s&&"border-red-500 bg-red-200","edit"===s&&"border-amber-500 bg-amber-200",t===x&&"outline-primary outline-2 outline-offset-2"),children:(0,a.jsxs)("span",{className:"sr-only",children:["Action ",t+1]})},t)})}),(0,a.jsx)(eY,{approveAllowed:_,hasEdited:E,hasAddedResponse:P,interruptValue:X,humanResponse:H,initialValues:V.current,setHumanResponse:K,supportsMultipleMethods:T,setSelectedSubmitType:F,setHasAddedResponse:B,setHasEdited:U,handleSubmit:C?()=>{let{decision:e,error:t}=eL(H,J);if(!e||t)return void R.oR.error("Error",{description:null!=t?t:"Unable to determine decision.",richColors:!0,closeButton:!0,duration:5e3});y(t=>{let r=new Map(t);return r.set(x,e),r}),(0,R.oR)("Success",{description:"Action ".concat(x+1," captured."),duration:3e3}),x<w.length-1&&h(e=>Math.min(w.length-1,e+1))}:O,isLoading:C?v:D,selectedSubmitType:J}),C&&(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(f,{variant:"outline",size:"sm",disabled:0===x,onClick:()=>h(e=>Math.max(0,e-1)),children:"Previous"}),(0,a.jsx)(f,{variant:"outline",size:"sm",disabled:x===w.length-1,onClick:()=>h(e=>Math.min(w.length-1,e+1)),children:"Next"})]}),(0,a.jsx)(f,{variant:"brand",disabled:!$||v,onClick:q,children:v?"Submitting...":"Submit all ".concat(w.length," decisions")})]}),!C&&z&&(0,a.jsx)("p",{className:"text-base font-medium text-green-600",children:"Successfully finished Graph invocation."})]})}function e0(e){var t,r,s,n;let{interrupt:i}=e,o=M(),c=(0,l.useMemo)(()=>(Array.isArray(i)?i:[i]).filter(e=>!!e),[i]),[u,m]=(0,l.useState)(0),[p,x]=(0,l.useState)(!1),[h,f]=(0,l.useState)(!1),g=p||h;(0,l.useEffect)(()=>{m(0)},[c.length]);let y=c[u],v=null!=(n=null==y||null==(s=y.value)||null==(r=s.action_requests)||null==(t=r[0])?void 0:t.description)?n:"",j=(e,t)=>{if(e&&t)return void console.error("Cannot show both state and description");e?(x(!1),f(!0)):t?(f(!1),x(!0)):(f(!1),x(!1))};return y?(0,a.jsx)("div",{className:"flex h-full w-full flex-col rounded-2xl bg-gray-50 p-8 lg:flex-row",children:g?(0,a.jsx)(eF,{handleShowSidePanel:j,description:v,values:o.values,view:h?"state":"description"}):(0,a.jsxs)("div",{className:"flex w-full flex-col gap-6",children:[c.length>1&&(0,a.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:c.map((e,t)=>{var r,s,l,n,i;let o=null!=(n=null==(l=e.value)||null==(s=l.action_requests)||null==(r=s[0])?void 0:r.name)?n:"Interrupt ".concat(t+1);return(0,a.jsx)("button",{type:"button",onClick:()=>m(t),className:d("rounded-full border px-3 py-1 text-sm transition-colors",t===u?"border-primary bg-primary/10 text-primary":"hover:border-primary hover:text-primary border-gray-300 bg-white text-gray-600"),children:o},null!=(i=e.id)?i:t)})}),(0,a.jsx)(eQ,{interrupt:y,handleShowSidePanel:j,showState:h,showDescription:p})]})}):null}function e1(e){return Array.isArray(e)||"object"==typeof e&&null!==e}function e2(e){if("string"!=typeof e)return!1;try{return new URL(e),e.startsWith("http://")||e.startsWith("https://")}catch(e){return!1}}function e3(e){let{interrupt:t}=e,[r,s]=(0,l.useState)(!1),i=JSON.stringify(t,null,2),o=i.split("\n").length>4||i.length>500,d=e=>{if("string"==typeof e&&e.length>100)return e2(e)?e:e.substring(0,100)+"...";if(Array.isArray(e)&&!r)return e.slice(0,2).map(d);if(e1(e)&&!r){let t=JSON.stringify(e,null,2);if(t.length>100)return"Truncated ".concat(t.length," characters...")}return e},c=(()=>{if(Array.isArray(t))return r?t:t.slice(0,5);{let e=Object.entries(t);return!r&&o?e.map(e=>{let[t,r]=e;return[t,d(r)]}):e}})();return(0,a.jsxs)("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 bg-gray-50 px-4 py-2",children:(0,a.jsx)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Human Interrupt"})})}),(0,a.jsxs)(n.P.div,{className:"min-w-full bg-gray-100",initial:!1,animate:{height:"auto"},transition:{duration:.3},children:[(0,a.jsx)("div",{className:"p-3",children:(0,a.jsx)(ee.N,{mode:"wait",initial:!1,children:(0,a.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},style:{maxHeight:r?"none":"500px",overflow:"auto"},children:(0,a.jsx)("table",{className:"min-w-full divide-y divide-gray-200",children:(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:c.map((e,r)=>{let[s,l]=Array.isArray(t)?[r.toString(),e]:e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-2 text-sm font-medium whitespace-nowrap text-gray-900",children:s}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-500",children:e1(l)?(0,a.jsx)("code",{className:"rounded bg-gray-50 px-2 py-1 font-mono text-sm",children:JSON.stringify(l,null,2)}):e2(l)?(0,a.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"break-all text-blue-600 underline hover:text-blue-800",children:l}):String(l)})]},r)})})})},r?"expanded":"collapsed")})}),(o||Array.isArray(t)&&t.length>5)&&(0,a.jsx)(n.P.button,{onClick:()=>s(!r),className:"flex w-full cursor-pointer items-center justify-center border-t-[1px] border-gray-200 py-2 text-gray-500 transition-all duration-200 ease-in-out hover:bg-gray-50 hover:text-gray-600",initial:{scale:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:r?(0,a.jsx)(ey.A,{}):(0,a.jsx)(ev.A,{})})]})]})}var e4=r(62194);let e5=(0,l.createContext)(null),e6=e=>{let t=(0,l.useContext)(e5),[r,s]=t.mounted,[n]=t.content,[i]=t.title,o=r===e.id,d=null==e.children&&null==e.title;return((0,l.useEffect)(()=>{d&&s(t=>t===e.id?null:t)},[d,s,e.id]),o)?(0,a.jsxs)(a.Fragment,{children:[null!=i?(0,e4.createPortal)((0,a.jsx)(a.Fragment,{children:e.title}),i):null,null!=n?(0,e4.createPortal)((0,a.jsx)(a.Fragment,{children:e.children}),n):null]}):null};function e9(e){let t=(0,l.useContext)(e5),[r]=t.mounted,s=(0,l.useRef)(null),[,n]=t.content;return((0,l.useLayoutEffect)(()=>null==n?void 0:n(r?s.current:null),[n,r]),r)?(0,a.jsx)("div",{...e,ref:s}):null}function e8(e){let t=(0,l.useContext)(e5),r=(0,l.useRef)(null),[,s]=t.title;return(0,l.useLayoutEffect)(()=>null==s?void 0:s(r.current),[s]),(0,a.jsx)("div",{...e,ref:r})}function e7(e){let t=(0,l.useState)(null),r=(0,l.useState)(null),s=(0,l.useState)(null),n=(0,l.useState)(null),i=(0,l.useState)({});return(0,a.jsx)(e5.Provider,{value:{open:s,mounted:n,title:r,content:t,context:i},children:e.children})}function te(e){var t;let{message:r,thread:s}=e,n=function(){let e=(0,l.useId)(),t=(0,l.useContext)(e5),[r,s]=t.open,[n,i]=t.context,[,o]=t.mounted,d=r===e,c=(0,l.useCallback)(t=>{"boolean"==typeof t?s(t?e:null):s(t=>t===e?null:e),o(e)},[s,o,e]);return[(0,l.useCallback)(t=>(0,a.jsx)(e6,{id:e,title:t.title,children:t.children}),[e]),{open:d,setOpen:c,context:n,setContext:i}]}(),{values:i}=M(),o=null==(t=i.ui)?void 0:t.filter(e=>{var t;return(null==(t=e.metadata)?void 0:t.message_id)===r.id});return(null==o?void 0:o.length)?(0,a.jsx)(a.Fragment,{children:o.map(e=>(0,a.jsx)(u.Pr,{stream:s,message:e,meta:{ui:e,artifact:n}},e.id))},r.id):null}function tt(e){var t;let{interrupt:r,isLastMessage:s,hasNoAIOrToolMessages:l}=e,n=Array.isArray(r)?r:null!=(t=null==r?void 0:r.value)?t:r;return(0,a.jsxs)(a.Fragment,{children:[eN(r)&&(s||l)&&(0,a.jsx)(e0,{interrupt:r}),r&&!eN(r)&&(s||l)?(0,a.jsx)(e3,{interrupt:n}):null]})}function tr(e){var t,r,s;let{message:l,isLoading:n,handleRegenerate:i}=e,o=null!=(s=null==l?void 0:l.content)?s:[],c=F(o),[u]=(0,m.ZA)("hideToolCalls",m.cr.withDefault(!1)),p=M(),x=p.messages[p.messages.length-1].id===(null==l?void 0:l.id),h=!p.messages.find(e=>"ai"===e.type||"tool"===e.type),f=l?p.getMessagesMetadata(l):void 0,g=p.interrupt,y=null==f||null==(t=f.firstSeenState)?void 0:t.parent_checkpoint,v=Array.isArray(o)?o.filter(e=>"tool_use"===e.type&&e.id).map(e=>{var t,r,a;let s={};if(null==e?void 0:e.input)try{s=null!=(t=(0,I.d1)(e.input))?t:{}}catch(e){}return{name:null!=(r=e.name)?r:"",id:null!=(a=e.id)?a:"",args:s,type:"tool_call"}}):void 0,j=l&&"tool_calls"in l&&l.tool_calls&&l.tool_calls.length>0,b=j&&(null==(r=l.tool_calls)?void 0:r.some(e=>e.args&&Object.keys(e.args).length>0)),w=!!(null==v?void 0:v.length),N=(null==l?void 0:l.type)==="tool";return N&&u?null:(0,a.jsx)("div",{className:"group mr-auto flex w-full items-start gap-2",children:(0,a.jsx)("div",{className:"flex w-full flex-col gap-2",children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ew,{message:l}),(0,a.jsx)(tt,{interrupt:g,isLastMessage:x,hasNoAIOrToolMessages:h})]}):(0,a.jsxs)(a.Fragment,{children:[c.length>0&&(0,a.jsx)("div",{className:"py-1",children:(0,a.jsx)(eg,{children:c})}),!u&&(0,a.jsx)(a.Fragment,{children:j&&b&&(0,a.jsx)(eb,{toolCalls:l.tool_calls})||w&&(0,a.jsx)(eb,{toolCalls:v})||j&&(0,a.jsx)(eb,{toolCalls:l.tool_calls})}),l&&(0,a.jsx)(te,{message:l,thread:p}),(0,a.jsx)(tt,{interrupt:g,isLastMessage:x,hasNoAIOrToolMessages:h}),(0,a.jsxs)("div",{className:d("mr-auto flex items-center gap-2 transition-opacity","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100"),children:[(0,a.jsx)(er,{branch:null==f?void 0:f.branch,branchOptions:null==f?void 0:f.branchOptions,onSelect:e=>p.setBranch(e),isLoading:n}),(0,a.jsx)(ea,{content:c,isLoading:n,isAiMessage:!0,handleRegenerate:()=>i(y)})]})]})})})}function ta(){return(0,a.jsx)("div",{className:"mr-auto flex items-start gap-2",children:(0,a.jsxs)("div",{className:"bg-muted flex h-8 items-center gap-1 rounded-2xl px-4 py-2",children:[(0,a.jsx)("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_infinite] rounded-full"}),(0,a.jsx)("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_0.5s_infinite] rounded-full"}),(0,a.jsx)("div",{className:"bg-foreground/50 h-1.5 w-1.5 animate-[pulse_1.5s_ease-in-out_1s_infinite] rounded-full"})]})})}var ts=r(15656),tl=r(22906);let tn=e=>{var t,r,s;let{block:l,removable:n=!1,onRemove:i,className:o,size:c="md"}=e;if("image"===l.type&&"string"==typeof l.mimeType&&l.mimeType.startsWith("image/")){let e="data:".concat(l.mimeType,";base64,").concat(l.data),r="rounded-md object-cover h-16 w-16 text-lg";return"sm"===c&&(r="rounded-md object-cover h-10 w-10 text-base"),"lg"===c&&(r="rounded-md object-cover h-24 w-24 text-xl"),(0,a.jsxs)("div",{className:d("relative inline-block",o),children:[(0,a.jsx)(tl.default,{src:e,alt:String((null==(t=l.metadata)?void 0:t.name)||"uploaded image"),className:r,width:"sm"===c?16:"md"===c?32:48,height:"sm"===c?16:"md"===c?32:48}),n&&(0,a.jsx)("button",{type:"button",className:"absolute top-1 right-1 z-10 rounded-full bg-gray-500 text-white hover:bg-gray-700",onClick:i,"aria-label":"Remove image",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]})}if("file"===l.type&&"application/pdf"===l.mimeType){let e=(null==(r=l.metadata)?void 0:r.filename)||(null==(s=l.metadata)?void 0:s.name)||"PDF file";return(0,a.jsxs)("div",{className:d("relative flex items-start gap-2 rounded-md border bg-gray-100 px-3 py-2",o),children:[(0,a.jsx)("div",{className:"flex flex-shrink-0 flex-col items-start justify-start",children:(0,a.jsx)(ts.A,{className:d("text-teal-700","sm"===c?"h-5 w-5":"h-7 w-7")})}),(0,a.jsx)("span",{className:d("min-w-0 flex-1 text-sm break-all text-gray-800"),style:{wordBreak:"break-all",whiteSpace:"pre-wrap"},children:String(e)}),n&&(0,a.jsx)("button",{type:"button",className:"ml-2 self-start rounded-full bg-gray-200 p-1 text-teal-700 hover:bg-gray-300",onClick:i,"aria-label":"Remove PDF",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]})}return(0,a.jsxs)("div",{className:d("flex items-center gap-2 rounded-md border bg-gray-100 px-3 py-2 text-gray-500",o),children:[(0,a.jsx)(ts.A,{className:"h-5 w-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:"Unsupported file type"}),n&&(0,a.jsx)("button",{type:"button",className:"ml-2 rounded-full bg-gray-200 p-1 text-gray-500 hover:bg-gray-300",onClick:i,"aria-label":"Remove file",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})]})};async function ti(e){let t=["image/jpeg","image/png","image/gif","image/webp"],r=[...t,"application/pdf"];if(!r.includes(e.type))return R.oR.error("Unsupported file type: ".concat(e.type,". Supported types are: ").concat(r.join(", "))),Promise.reject(Error("Unsupported file type: ".concat(e.type)));let a=await to(e);return t.includes(e.type)?{type:"image",mimeType:e.type,data:a,metadata:{name:e.name}}:{type:"file",mimeType:"application/pdf",data:a,metadata:{filename:e.name}}}async function to(e){return new Promise((t,r)=>{let a=new FileReader;a.onloadend=()=>{t(a.result.split(",")[1])},a.onerror=r,a.readAsDataURL(e)})}function td(e){let{value:t,setValue:r,onSubmit:s}=e;return(0,a.jsx)(eU,{value:t,onChange:e=>r(e.target.value),onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),s())},className:"focus-visible:ring-0"})}function tc(e){var t;let{message:r,isLoading:s}=e,n=M(),i=n.getMessagesMetadata(r),o=null==i||null==(t=i.firstSeenState)?void 0:t.parent_checkpoint,[c,u]=(0,l.useState)(!1),[m,p]=(0,l.useState)(""),x=F(r.content),h=()=>{u(!1);let e={type:"human",content:m};n.submit({messages:[e]},{checkpoint:o,streamMode:["values"],streamSubgraphs:!0,streamResumable:!0,optimisticValues:t=>{var r,a;let s=null==i||null==(r=i.firstSeenState)?void 0:r.values;return s?{...s,messages:[...null!=(a=s.messages)?a:[],e]}:t}})};return(0,a.jsx)("div",{className:d("group ml-auto flex items-center gap-2",c&&"w-full max-w-xl"),children:(0,a.jsxs)("div",{className:d("flex flex-col gap-2",c&&"w-full"),children:[c?(0,a.jsx)(td,{value:m,setValue:p,onSubmit:h}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[Array.isArray(r.content)&&r.content.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap items-end justify-end gap-2",children:r.content.reduce((e,t,r)=>("object"==typeof t&&null!==t&&"type"in t&&("file"===t.type&&"mimeType"in t&&"string"==typeof t.mimeType&&(t.mimeType.startsWith("image/")||"application/pdf"===t.mimeType)||"image"===t.type&&"mimeType"in t&&"string"==typeof t.mimeType&&t.mimeType.startsWith("image/")||0)&&e.push((0,a.jsx)(tn,{block:t,size:"md"},r)),e),[])}),x?(0,a.jsx)("p",{className:"bg-muted ml-auto w-fit rounded-3xl px-4 py-2 text-right whitespace-pre-wrap",children:x}):null]}),(0,a.jsxs)("div",{className:d("ml-auto flex items-center gap-2 transition-opacity","opacity-0 group-focus-within:opacity-100 group-hover:opacity-100",c&&"opacity-100"),children:[(0,a.jsx)(er,{branch:null==i?void 0:i.branch,branchOptions:null==i?void 0:i.branchOptions,onSelect:e=>n.setBranch(e),isLoading:s}),(0,a.jsx)(ea,{isLoading:s,content:x,isEditing:c,setIsEditing:e=>{e&&p(x),u(e)},handleSubmitEdit:h,isHumanMessage:!0})]})]})})}let tu="do-not-render-";var tm=r(53918),tp=r(45986),tx=r(18430),th=r(49827),tf=r(52550),tg=r(46484),ty=r(71708),tv=r(21557);function tj(e){let{...t}=e;return(0,a.jsx)(tv.bL,{"data-slot":"sheet",...t})}function tb(e){let{...t}=e;return(0,a.jsx)(tv.ZL,{"data-slot":"sheet-portal",...t})}function tw(e){let{className:t,...r}=e;return(0,a.jsx)(tv.hJ,{"data-slot":"sheet-overlay",className:d("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t),...r})}function tN(e){let{className:t,children:r,side:s="right",...l}=e;return(0,a.jsxs)(tb,{children:[(0,a.jsx)(tw,{}),(0,a.jsxs)(tv.UC,{"data-slot":"sheet-content",className:d("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===s&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===s&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===s&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===s&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...l,children:[r,(0,a.jsxs)(tv.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,a.jsx)(J.A,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function tC(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"sheet-header",className:d("flex flex-col gap-1.5 p-4",t),...r})}function tA(e){let{className:t,...r}=e;return(0,a.jsx)(tv.hE,{"data-slot":"sheet-title",className:d("text-foreground font-semibold",t),...r})}function tk(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"skeleton",className:d("bg-primary/10 animate-pulse rounded-md",t),...r})}function tS(e){let[t,r]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let t=window.matchMedia(e);r(t.matches);let a=e=>r(e.matches);return t.addEventListener("change",a),()=>t.removeEventListener("change",a)},[e]),t}function t_(e){let{threads:t,onThreadClick:r}=e,[s,l]=(0,m.ZA)("threadId");return(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-start justify-start gap-2 overflow-y-scroll [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",children:t.map(e=>{var t;let n=e.thread_id;return"object"==typeof e.values&&e.values&&"messages"in e.values&&Array.isArray(e.values.messages)&&(null==(t=e.values.messages)?void 0:t.length)>0&&(n=F(e.values.messages[0].content)),(0,a.jsx)("div",{className:"w-full px-1",children:(0,a.jsx)(f,{variant:"ghost",className:"w-[280px] items-start justify-start text-left font-normal",onClick:t=>{t.preventDefault(),null==r||r(e.thread_id),e.thread_id!==s&&l(e.thread_id)},children:(0,a.jsx)("p",{className:"truncate text-ellipsis",children:n})})},e.thread_id)})})}function tE(){return(0,a.jsx)("div",{className:"flex h-full w-full flex-col items-start justify-start gap-2 overflow-y-scroll [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",children:Array.from({length:30}).map((e,t)=>(0,a.jsx)(tk,{className:"h-10 w-[280px]"},"skeleton-".concat(t)))})}function tR(){let e=tS("(min-width: 1024px)"),[t,r]=(0,m.ZA)("chatHistoryOpen",m.cr.withDefault(!1)),{getThreads:s,threads:n,setThreads:i,threadsLoading:o,setThreadsLoading:d}=E();return(0,l.useEffect)(()=>{d(!0),s().then(i).catch(console.error).finally(()=>d(!1))},[s,i,d]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"shadow-inner-right hidden h-screen w-[300px] shrink-0 flex-col items-start justify-start gap-6 border-r-[1px] border-slate-300 lg:flex",children:[(0,a.jsxs)("div",{className:"flex w-full items-center justify-between px-4 pt-1.5",children:[(0,a.jsx)(f,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>r(e=>!e),children:t?(0,a.jsx)(tp.A,{className:"size-5"}):(0,a.jsx)(tx.A,{className:"size-5"})}),(0,a.jsx)("h1",{className:"text-xl font-semibold tracking-tight",children:"Thread History"})]}),o?(0,a.jsx)(tE,{}):(0,a.jsx)(t_,{threads:n})]}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsx)(tj,{open:!!t&&!e,onOpenChange:t=>{e||r(t)},children:(0,a.jsxs)(tN,{side:"left",className:"flex lg:hidden",children:[(0,a.jsx)(tC,{children:(0,a.jsx)(tA,{children:"Thread History"})}),(0,a.jsx)(t_,{threads:n,onThreadClick:()=>r(e=>!e)})]})})})]})}var tP=r(23569);function tL(e){let{className:t,...r}=e;return(0,a.jsx)(tP.bL,{"data-slot":"switch",className:d("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 inline-flex h-5 w-9 shrink-0 items-center rounded-full border-2 border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:(0,a.jsx)(tP.zi,{"data-slot":"switch-thumb",className:d("bg-background pointer-events-none block size-4 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})}let tT=e=>{let{width:t="100%",height:r="100%"}=e;return(0,a.jsxs)("svg",{role:"img",viewBox:"0 0 24 24",width:t,height:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("title",{children:"GitHub"}),(0,a.jsx)("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"})]})},tz=["image/jpeg","image/png","image/gif","image/webp","application/pdf"],tD=e=>{let{blocks:t,onRemove:r,size:s="md",className:l}=e;return t.length?(0,a.jsx)("div",{className:d("flex flex-wrap gap-2 p-3.5 pb-0",l),children:t.map((e,t)=>(0,a.jsx)(tn,{block:e,removable:!0,onRemove:()=>r(t),size:s},t))}):null};function tO(e){let t=(0,ty.B)();return(0,a.jsxs)("div",{ref:t.scrollRef,style:{width:"100%",height:"100%"},className:e.className,children:[(0,a.jsx)("div",{ref:t.contentRef,className:e.contentClassName,children:e.content}),e.footer]})}function tM(e){let{isAtBottom:t,scrollToBottom:r}=(0,ty.B)();return t?null:(0,a.jsxs)(f,{variant:"outline",className:e.className,onClick:()=>r(),children:[(0,a.jsx)(tm.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Scroll to bottom"})]})}function tI(){return(0,a.jsx)(W,{children:(0,a.jsxs)(Y,{children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsx)("a",{href:"https://github.com/langchain-ai/agent-chat-ui",target:"_blank",className:"flex items-center justify-center",children:(0,a.jsx)(tT,{width:"24",height:"24"})})}),(0,a.jsx)(X,{side:"left",children:(0,a.jsx)("p",{children:"Open GitHub repo"})})]})})}function tF(){let[e,t]=(0,l.useContext)(e5).context,[r,i]=function(){let[e,t]=(0,l.useContext)(e5).open;return[null!==e,(0,l.useCallback)(()=>t(null),[t])]}(),[o,c]=(0,m.ZA)("threadId"),[u,p]=(0,m.ZA)("chatHistoryOpen",m.cr.withDefault(!1)),[x,h]=(0,m.ZA)("hideToolCalls",m.cr.withDefault(!1)),[y,j]=(0,l.useState)(""),{contentBlocks:b,setContentBlocks:w,handleFileUpload:N,dropRef:C,removeBlock:A,resetBlocks:k,dragOver:S,handlePaste:_}=function(){let{initialBlocks:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,l.useState)(e),a=(0,l.useRef)(null),[s,n]=(0,l.useState)(!1),i=(0,l.useRef)(0),o=(e,t)=>"application/pdf"===e.type?t.some(t=>{var r;return"file"===t.type&&"application/pdf"===t.mimeType&&(null==(r=t.metadata)?void 0:r.filename)===e.name}):!!tz.includes(e.type)&&t.some(t=>{var r;return"image"===t.type&&(null==(r=t.metadata)?void 0:r.name)===e.name&&t.mimeType===e.type}),d=async e=>{let a=e.target.files;if(!a)return;let s=Array.from(a),l=s.filter(e=>tz.includes(e.type)),n=s.filter(e=>!tz.includes(e.type)),i=l.filter(e=>o(e,t)),d=l.filter(e=>!o(e,t));n.length>0&&R.oR.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),i.length>0&&R.oR.error("Duplicate file(s) detected: ".concat(i.map(e=>e.name).join(", "),". Each file can only be uploaded once per message."));let c=d.length?await Promise.all(d.map(ti)):[];r(e=>[...e,...c]),e.target.value=""};(0,l.useEffect)(()=>{if(!a.current)return;let e=e=>{var t,r;(null==(r=e.dataTransfer)||null==(t=r.types)?void 0:t.includes("Files"))&&(i.current+=1,n(!0))},s=e=>{var t,r;(null==(r=e.dataTransfer)||null==(t=r.types)?void 0:t.includes("Files"))&&(i.current-=1,i.current<=0&&(n(!1),i.current=0))},l=async e=>{if(e.preventDefault(),e.stopPropagation(),i.current=0,n(!1),!e.dataTransfer)return;let a=Array.from(e.dataTransfer.files),s=a.filter(e=>tz.includes(e.type)),l=a.filter(e=>!tz.includes(e.type)),d=s.filter(e=>o(e,t)),c=s.filter(e=>!o(e,t));l.length>0&&R.oR.error("You have uploaded invalid file type. Please upload a JPEG, PNG, GIF, WEBP image or a PDF."),d.length>0&&R.oR.error("Duplicate file(s) detected: ".concat(d.map(e=>e.name).join(", "),". Each file can only be uploaded once per message."));let u=c.length?await Promise.all(c.map(ti)):[];r(e=>[...e,...u])},d=e=>{i.current=0,n(!1)};window.addEventListener("dragenter",e),window.addEventListener("dragleave",s),window.addEventListener("drop",l),window.addEventListener("dragend",d);let c=e=>{e.preventDefault(),e.stopPropagation()};window.addEventListener("dragover",c);let u=e=>{e.preventDefault(),e.stopPropagation(),n(!0)},m=e=>{e.preventDefault(),e.stopPropagation(),n(!0)},p=e=>{e.preventDefault(),e.stopPropagation(),n(!1)},x=a.current;return x.addEventListener("dragover",u),x.addEventListener("dragenter",m),x.addEventListener("dragleave",p),()=>{x.removeEventListener("dragover",u),x.removeEventListener("dragenter",m),x.removeEventListener("dragleave",p),window.removeEventListener("dragenter",e),window.removeEventListener("dragleave",s),window.removeEventListener("drop",l),window.removeEventListener("dragend",d),window.removeEventListener("dragover",c),i.current=0}},[t]);let c=async e=>{let a=e.clipboardData.items;if(!a)return;let s=[];for(let e=0;e<a.length;e+=1){let t=a[e];if("file"===t.kind){let e=t.getAsFile();e&&s.push(e)}}if(0===s.length)return;e.preventDefault();let l=s.filter(e=>tz.includes(e.type)),n=s.filter(e=>!tz.includes(e.type)),i=e=>"application/pdf"===e.type?t.some(t=>{var r;return"file"===t.type&&"application/pdf"===t.mimeType&&(null==(r=t.metadata)?void 0:r.filename)===e.name}):!!tz.includes(e.type)&&t.some(t=>{var r;return"image"===t.type&&(null==(r=t.metadata)?void 0:r.name)===e.name&&t.mimeType===e.type}),o=l.filter(i),d=l.filter(e=>!i(e));if(n.length>0&&R.oR.error("You have pasted an invalid file type. Please paste a JPEG, PNG, GIF, WEBP image or a PDF."),o.length>0&&R.oR.error("Duplicate file(s) detected: ".concat(o.map(e=>e.name).join(", "),". Each file can only be uploaded once per message.")),d.length>0){let e=await Promise.all(d.map(ti));r(t=>[...t,...e])}};return{contentBlocks:t,setContentBlocks:r,handleFileUpload:d,dropRef:a,removeBlock:e=>{r(t=>t.filter((t,r)=>r!==e))},resetBlocks:()=>r([]),dragOver:s,handlePaste:c}}(),[E,P]=(0,l.useState)(!1),L=tS("(min-width: 1024px)"),T=M(),z=T.messages,D=T.isLoading,O=(0,l.useRef)(void 0),I=e=>{c(e),i(),t({})};(0,l.useEffect)(()=>{if(!T.error){O.current=void 0;return}try{let e=T.error.message;if(!e||O.current===e)return;O.current=e,R.oR.error("An error occurred. Please try again.",{description:(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Error:"})," ",(0,a.jsx)("code",{children:e})]}),richColors:!0,closeButton:!0})}catch(e){}},[T.error]);let F=(0,l.useRef)(0);(0,l.useEffect)(()=>{z.length!==F.current&&(null==z?void 0:z.length)&&"ai"===z[z.length-1].type&&P(!0),F.current=z.length},[z]);let B=e=>{F.current=F.current-1,P(!1),T.submit(void 0,{checkpoint:e,streamMode:["values"],streamSubgraphs:!0,streamResumable:!0})},U=!!o||!!z.length,H=!z.find(e=>"ai"===e.type||"tool"===e.type);return(0,a.jsxs)("div",{className:"flex h-screen w-full overflow-hidden",children:[(0,a.jsx)("div",{className:"relative hidden lg:flex",children:(0,a.jsx)(n.P.div,{className:"absolute z-20 h-full overflow-hidden border-r bg-white",style:{width:300},animate:{x:u?0:-300},initial:{x:-300},transition:L?{type:"spring",stiffness:300,damping:30}:{duration:0},children:(0,a.jsx)("div",{className:"relative h-full",style:{width:300},children:(0,a.jsx)(tR,{})})})}),(0,a.jsxs)("div",{className:d("grid w-full grid-cols-[1fr_0fr] transition-all duration-500",r&&"grid-cols-[3fr_2fr]"),children:[(0,a.jsxs)(n.P.div,{className:d("relative flex min-w-0 flex-1 flex-col overflow-hidden",!U&&"grid-rows-[1fr]"),layout:L,animate:{marginLeft:u?300*!!L:0,width:u&&L?"calc(100% - 300px)":"100%"},transition:L?{type:"spring",stiffness:300,damping:30}:{duration:0},children:[!U&&(0,a.jsxs)("div",{className:"absolute top-0 left-0 z-10 flex w-full items-center justify-between gap-3 p-2 pl-4",children:[(0,a.jsx)("div",{children:(!u||!L)&&(0,a.jsx)(f,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>p(e=>!e),children:u?(0,a.jsx)(tp.A,{className:"size-5"}):(0,a.jsx)(tx.A,{className:"size-5"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-4 flex items-center",children:(0,a.jsx)(tI,{})})]}),U&&(0,a.jsxs)("div",{className:"relative z-10 flex items-center justify-between gap-3 p-2",children:[(0,a.jsxs)("div",{className:"relative flex items-center justify-start gap-2",children:[(0,a.jsx)("div",{className:"absolute left-0 z-10",children:(!u||!L)&&(0,a.jsx)(f,{className:"hover:bg-gray-100",variant:"ghost",onClick:()=>p(e=>!e),children:u?(0,a.jsx)(tp.A,{className:"size-5"}):(0,a.jsx)(tx.A,{className:"size-5"})})}),(0,a.jsxs)(n.P.button,{className:"flex cursor-pointer items-center gap-2",onClick:()=>I(null),animate:{marginLeft:48*!u},transition:{type:"spring",stiffness:300,damping:30},children:[(0,a.jsx)(g,{width:32,height:32}),(0,a.jsx)("span",{className:"text-xl font-semibold tracking-tight",children:"VSDA Agent Chat"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(tI,{})}),(0,a.jsx)(Q,{size:"lg",className:"p-4",tooltip:"New thread",variant:"ghost",onClick:()=>I(null),children:(0,a.jsx)(th.A,{className:"size-5"})})]}),(0,a.jsx)("div",{className:"from-background to-background/0 absolute inset-x-0 top-full h-5 bg-gradient-to-b"})]}),(0,a.jsx)(ty.z,{className:"relative flex-1 overflow-hidden",children:(0,a.jsx)(tO,{className:d("absolute inset-0 overflow-y-scroll px-4 [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-track]:bg-transparent",!U&&"mt-[25vh] flex flex-col items-stretch",U&&"grid grid-rows-[1fr_auto]"),contentClassName:"pt-8 pb-16 max-w-3xl mx-auto flex flex-col gap-4 w-full",content:(0,a.jsxs)(a.Fragment,{children:[z.filter(e=>{var t;return!(null==(t=e.id)?void 0:t.startsWith(tu))}).map((e,t)=>"human"===e.type?(0,a.jsx)(tc,{message:e,isLoading:D},e.id||"".concat(e.type,"-").concat(t)):(0,a.jsx)(tr,{message:e,isLoading:D,handleRegenerate:B},e.id||"".concat(e.type,"-").concat(t))),H&&!!T.interrupt&&(0,a.jsx)(tr,{message:void 0,isLoading:D,handleRegenerate:B},"interrupt-msg"),D&&!E&&(0,a.jsx)(ta,{})]}),footer:(0,a.jsxs)("div",{className:"sticky bottom-0 flex flex-col items-center gap-8 bg-white",children:[!U&&(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(g,{className:"h-8 flex-shrink-0"}),(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight",children:"VSDA Agent Chat"})]}),(0,a.jsx)(tM,{className:"animate-in fade-in-0 zoom-in-95 absolute bottom-full left-1/2 mb-4 -translate-x-1/2"}),(0,a.jsx)("div",{ref:C,className:d("bg-muted relative z-10 mx-auto mb-8 w-full max-w-3xl rounded-2xl shadow-xs transition-all",S?"border-primary border-2 border-dotted":"border border-solid"),children:(0,a.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),0===y.trim().length&&0===b.length||D)return;P(!1);let r={id:(0,s.A)(),type:"human",content:[...y.trim().length>0?[{type:"text",text:y}]:[],...b]},a=function(e){let t=[];return e.forEach((r,a)=>{var l,n,i;if("ai"!==r.type||(null==(l=r.tool_calls)?void 0:l.length)===0)return;let o=e[a+1];o&&"tool"===o.type||t.push(...null!=(i=null==(n=r.tool_calls)?void 0:n.map(e=>{var t;return{type:"tool",tool_call_id:null!=(t=e.id)?t:"",id:"".concat(tu).concat((0,s.A)()),name:e.name,content:"Successfully handled tool call."}}))?i:[])}),t}(T.messages),l=Object.keys(e).length>0?e:void 0;T.submit({messages:[...a,r],context:l},{streamMode:["values"],streamSubgraphs:!0,streamResumable:!0,optimisticValues:e=>{var t;return{...e,context:l,messages:[...null!=(t=e.messages)?t:[],...a,r]}}}),j(""),w([])},className:"mx-auto grid max-w-3xl grid-rows-[1fr_auto] gap-2",children:[(0,a.jsx)(tD,{blocks:b,onRemove:A}),(0,a.jsx)("textarea",{value:y,onChange:e=>j(e.target.value),onPaste:_,onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey&&!e.metaKey&&!e.nativeEvent.isComposing){e.preventDefault();let t=e.target,r=null==t?void 0:t.closest("form");null==r||r.requestSubmit()}},placeholder:"Type your message...",className:"field-sizing-content resize-none border-none bg-transparent p-3.5 pb-0 shadow-none ring-0 outline-none focus:ring-0 focus:outline-none"}),(0,a.jsxs)("div",{className:"flex items-center gap-6 p-2 pt-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(tL,{id:"render-tool-calls",checked:null!=x&&x,onCheckedChange:h}),(0,a.jsx)(v,{htmlFor:"render-tool-calls",className:"text-sm text-gray-600",children:"Hide Tool Calls"})]})}),(0,a.jsxs)(v,{htmlFor:"file-input",className:"flex cursor-pointer items-center gap-2",children:[(0,a.jsx)(tf.A,{className:"size-5 text-gray-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Upload PDF or Image"})]}),(0,a.jsx)("input",{id:"file-input",type:"file",onChange:N,multiple:!0,accept:"image/jpeg,image/png,image/gif,image/webp,application/pdf",className:"hidden"}),T.isLoading?(0,a.jsxs)(f,{onClick:()=>T.stop(),className:"ml-auto",children:[(0,a.jsx)(tg.A,{className:"h-4 w-4 animate-spin"}),"Cancel"]},"stop"):(0,a.jsx)(f,{type:"submit",className:"ml-auto shadow-md transition-all",disabled:D||!y.trim()&&0===b.length,children:"Send"})]})]})})]})})})]}),(0,a.jsx)("div",{className:"relative flex flex-col border-l",children:(0,a.jsxs)("div",{className:"absolute inset-0 flex min-w-[30vw] flex-col",children:[(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_auto] border-b p-4",children:[(0,a.jsx)(e8,{className:"truncate overflow-hidden"}),(0,a.jsx)("button",{onClick:i,className:"cursor-pointer",children:(0,a.jsx)(J.A,{className:"size-5"})})]}),(0,a.jsx)(e9,{className:"relative flex-grow"})]})})]})]})}var tB=r(47014);let tU=e=>{let{...t}=e,{theme:r="system"}=(0,tB.D)();return(0,a.jsx)(R.l$,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground font-medium",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground font-medium"}},...t})};function tH(){return(0,a.jsxs)(l.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading (layout)..."}),children:[(0,a.jsx)(tU,{}),(0,a.jsx)(_,{children:(0,a.jsx)(O,{children:(0,a.jsx)(e7,{children:(0,a.jsx)(tF,{})})})})]})}},67941:(e,t,r)=>{Promise.resolve().then(r.bind(r,53718))},87527:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[2343,8447,3200,4325,4172,7358],()=>t(67941)),_N_E=e.O()}]);